---
apiVersion: epca.eo/v1beta1
kind: XStorage
metadata:
  labels:
    crossplane.io/claim-name: alice-003
    crossplane.io/claim-namespace: default
  name: alice-003
spec:
  bucketAccessRequests:
  - bucketName: bob-shared-003
    permission: ReadWrite
  buckets:
  - bucketName: alice-003
    discoverable: false
  - bucketName: alice-shared-003
    discoverable: true
  owner: alice-003
status:
  conditions:
  - lastTransitionTime: "2024-01-01T00:00:00Z"
    message: 'Unready resources: check-policy-alice-003.readwrite.bob-shared-003'
    reason: Creating
    status: "False"
    type: Ready
---
apiVersion: minio.crossplane.io/v1
kind: Bucket
metadata:
  annotations:
    crossplane.io/composition-resource-name: bucket-alice-003-alice-003
    xstorages.epca.eo/discoverable: "false"
  generateName: alice-003-
  labels:
    crossplane.io/composite: alice-003
  ownerReferences:
  - apiVersion: epca.eo/v1beta1
    blockOwnerDeletion: true
    controller: true
    kind: XStorage
    name: alice-003
    uid: ""
spec:
  providerConfigRef:
    name: storage-minio
---
apiVersion: minio.crossplane.io/v1
kind: Bucket
metadata:
  annotations:
    crossplane.io/composition-resource-name: bucket-alice-003-alice-shared-003
    xstorages.epca.eo/discoverable: "true"
  generateName: alice-003-
  labels:
    crossplane.io/composite: alice-003
  ownerReferences:
  - apiVersion: epca.eo/v1beta1
    blockOwnerDeletion: true
    controller: true
    kind: XStorage
    name: alice-003
    uid: ""
spec:
  providerConfigRef:
    name: storage-minio
---
apiVersion: kubernetes.crossplane.io/v1alpha2
kind: Object
metadata:
  annotations:
    crossplane.io/composition-resource-name: check-policy-alice-003.readwrite.bob-shared-003
  generateName: alice-003-
  labels:
    crossplane.io/composite: alice-003
  name: policy-observer-alice-003.readwrite.bob-shared-003
  ownerReferences:
  - apiVersion: epca.eo/v1beta1
    blockOwnerDeletion: true
    controller: true
    kind: XStorage
    name: alice-003
    uid: ""
spec:
  forProvider:
    manifest:
      apiVersion: minio.crossplane.io/v1
      kind: Policy
      metadata:
        name: alice-003.readwrite.bob-shared-003
  managementPolicies:
  - Observe
  providerConfigRef:
    name: storage-kubernetes
---
apiVersion: minio.crossplane.io/v1
kind: Policy
metadata:
  annotations:
    crossplane.io/composition-resource-name: policy-alice-003.owner.alice-003
  generateName: alice-003-
  labels:
    crossplane.io/composite: alice-003
  ownerReferences:
  - apiVersion: epca.eo/v1beta1
    blockOwnerDeletion: true
    controller: true
    kind: XStorage
    name: alice-003
    uid: ""
spec:
  forProvider:
    rawPolicy: |
      {
        "Version": "2012-10-17",
        "Statement": [
          {
            "Effect": "Allow",
            "Action": [ "s3:*" ],
            "Resource": [
              "arn:aws:s3:::alice-003",
              "arn:aws:s3:::alice-003/*"
            ]
          }
        ]
      }
  providerConfigRef:
    name: storage-minio
---
apiVersion: minio.crossplane.io/v1
kind: Policy
metadata:
  annotations:
    crossplane.io/composition-resource-name: policy-alice-003.owner.alice-shared-003
  generateName: alice-003-
  labels:
    crossplane.io/composite: alice-003
  ownerReferences:
  - apiVersion: epca.eo/v1beta1
    blockOwnerDeletion: true
    controller: true
    kind: XStorage
    name: alice-003
    uid: ""
spec:
  forProvider:
    rawPolicy: |
      {
        "Version": "2012-10-17",
        "Statement": [
          {
            "Effect": "Allow",
            "Action": [ "s3:*" ],
            "Resource": [
              "arn:aws:s3:::alice-shared-003",
              "arn:aws:s3:::alice-shared-003/*"
            ]
          }
        ]
      }
  providerConfigRef:
    name: storage-minio
---
apiVersion: minio.crossplane.io/v1
kind: User
metadata:
  annotations:
    crossplane.io/composition-resource-name: user-alice-003
  generateName: alice-003-
  labels:
    crossplane.io/composite: alice-003
  ownerReferences:
  - apiVersion: epca.eo/v1beta1
    blockOwnerDeletion: true
    controller: true
    kind: XStorage
    name: alice-003
    uid: ""
spec:
  forProvider:
    policies:
    - alice-003.owner.alice-003
    - alice-003.owner.alice-shared-003
    userName: alice-003
  providerConfigRef:
    name: storage-minio
  writeConnectionSecretToRef:
    name: alice-003
    namespace: default
