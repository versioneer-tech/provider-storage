
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://versioneer-tech.github.io/provider-storage/v0.2/how-to-guides/storage-minio/">
      
      
        <link rel="prev" href="../general/">
      
      
        <link rel="next" href="../storage-aws/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>storage-minio - provider-storage</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#how-to-guides-storage-minio" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="provider-storage" class="md-header__button md-logo" aria-label="provider-storage" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            provider-storage
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              storage-minio
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="provider-storage" class="md-nav__button md-logo" aria-label="provider-storage" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    provider-storage
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/storage-minio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    storage-minio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/storage-aws/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    storage-aws
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    How-to guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            How-to guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../general/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    general
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    storage-minio
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    storage-minio
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-guides" class="md-nav__link">
    <span class="md-ellipsis">
      How-to guides
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How-to guides">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-install-the-storage-minio-configuration-package" class="md-nav__link">
    <span class="md-ellipsis">
      How to install the storage-minio configuration package
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-create-buckets-with-storage-minio" class="md-nav__link">
    <span class="md-ellipsis">
      How to create Buckets with storage-minio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-request-access-to-buckets-from-other-owners" class="md-nav__link">
    <span class="md-ellipsis">
      How to request access to Buckets from other owners
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-grant-access-to-buckets-to-other-owners" class="md-nav__link">
    <span class="md-ellipsis">
      How to grant access to Buckets to other owners
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../storage-aws/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    storage-aws
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reference guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reference guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference-guides/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-guides" class="md-nav__link">
    <span class="md-ellipsis">
      How-to guides
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How-to guides">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-install-the-storage-minio-configuration-package" class="md-nav__link">
    <span class="md-ellipsis">
      How to install the storage-minio configuration package
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-create-buckets-with-storage-minio" class="md-nav__link">
    <span class="md-ellipsis">
      How to create Buckets with storage-minio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-request-access-to-buckets-from-other-owners" class="md-nav__link">
    <span class="md-ellipsis">
      How to request access to Buckets from other owners
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-grant-access-to-buckets-to-other-owners" class="md-nav__link">
    <span class="md-ellipsis">
      How to grant access to Buckets to other owners
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="how-to-guides-storage-minio">How-to guides: storage-minio</h1>
<p>The <code>storage-minio</code> configuration package allows the creation of <code>buckets</code> on a <a href="https://min.io/">MinIO</a> backend and automatically creates <a href="https://min.io/docs/minio/linux/administration/identity-access-management/policy-based-access-control.html">Policies</a> for permission control. Furthermore, <code>storage-minio</code> includes a workflow to request/grant access to <code>buckets</code> from other <code>owners</code>.</p>
<h2 id="how-to-guides">How-to guides</h2>
<ul>
<li><a href="#how-to-install-the-storage-minio-configuration-package">How to install the <code>storage-minio</code> configuration package</a></li>
<li><a href="#how-to-create-buckets-with-storage-minio">How to create <code>Buckets</code> with <code>storage-minio</code></a></li>
<li><a href="#how-to-request-access-to-buckets-from-other-owners">How to request access to <code>Buckets</code> from other <code>owners</code></a></li>
<li><a href="#how-to-grant-access-to-buckets-to-other-owners">How to grant access to <code>Buckets</code> to other <code>owners</code></a></li>
</ul>
<h3 id="how-to-install-the-storage-minio-configuration-package">How to install the <code>storage-minio</code> configuration package</h3>
<p>The <code>storage-minio</code> configuration package can be installed like any other configuration package with</p>
<pre><code class="language-yaml">apiVersion: pkg.crossplane.io/v1
kind: Configuration
metadata:
  name: storage-minio
spec:
  package: ghcr.io/versioneer-tech/provider-storage:v0.2-minio
</code></pre>
<p>This automatically installs the necessary dependencies:</p>
<ul>
<li><a href="https://github.com/vshn/provider-minio">provider-minio</a> &gt;= v0.4.4</li>
<li><a href="https://github.com/crossplane-contrib/provider-kubernetes">provider-kubernetes</a> &gt;= v0.18.0</li>
<li><a href="https://github.com/crossplane-contrib/function-auto-ready">function-auto-ready</a> &gt;= 0.5.0</li>
<li><a href="https://github.com/crossplane-contrib/function-go-templating">function-go-templating</a> &gt;= v0.10.0</li>
</ul>
<p>However, it does not install the necessary <code>ProviderConfigs</code>, <code>ServiceAccounts</code> and <code>Secrets</code> that are actually needed for the <code>storage-minio</code> to work.</p>
<p>The <code>provider-minio</code> needs to know how to access the MinIO instance and also needs credentials for it. Therefore, it needs a <code>Secret</code> which includes the access key and secret key.</p>
<pre><code class="language-yaml">apiVersion: v1
kind: Secret
metadata:
  name: &lt;name&gt;
  namespace: &lt;namespace&gt;
stringData:
  AWS_ACCESS_KEY_ID: &lt;Access Key&gt;
  AWS_SECRET_ACCESS_KEY: &lt;Secret Key&gt;
</code></pre>
<p>Furthermore, the <code>ProviderConfig</code> needs to reference this secret and also provide the URL for the MinIO instance.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The name of the <code>ProviderConfig</code> needs to be <code>storage-minio</code>! The composition will not work with any other name and will not be able to create resources!</p>
</div>
<pre><code class="language-yaml">apiVersion: minio.crossplane.io/v1
kind: ProviderConfig
metadata:
  name: storage-minio
  namespace: crossplane-system
spec:
  credentials:
    apiSecretRef:
      name: &lt;secretName&gt;
      namespace: &lt;secretNamespace&gt;
    source: InjectedIdentity
  minioURL: &lt;url&gt;
</code></pre>
<p>The <code>provider-kubernetes</code> needs a <code>ServiceAccount</code> that can observe resources from <code>policies.minio.crossplane.io</code>. Below is an example <code>ClusterRole</code> which expands the default <code>ClusterRole</code> created by <code>crossplane-rbac</code>.</p>
<pre><code class="language-yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: &lt;name&gt;
rules:
- apiGroups:
  - kubernetes.crossplane.io
  resources:
  - objects
  - objects/status
  - observedobjectcollections
  - observedobjectcollections/status
  - providerconfigs
  - providerconfigs/status
  - providerconfigusages
  - providerconfigusages/status
  verbs:
  - get
  - list
  - watch
  - update
  - patch
  - create
- apiGroups:
  - kubernetes.crossplane.io
  resources:
  - '*/finalizers'
  verbs:
  - update
- apiGroups:
  - coordination.k8s.io
  resources:
  - secrets
  - configmaps
  - events
  - leases
  verbs:
  - '*'
- apiGroups:
  - minio.crossplane.io
  resources:
  - policies
  verbs:
  - watch
  - get
</code></pre>
<p>When the <code>ClusterRole</code> is attached to the <code>ServiceAccount</code> via a <code>ClusterRoleBinding</code>, the actual <code>provider-kubernetes</code> can be updated with a <code>DeploymentRuntimeConfig</code> to use the newly created <code>ServiceAccount</code>. Furthermore, a standard <code>ProviderConfig</code> can be applied.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure that the <code>name</code> and version of the <code>Provider</code> matches the name of the Kubernetes provider that is already installed in your cluster! If it does not match, <code>crossplane</code> installs a new Kubernetes provider with the given name. The standard name is <code>crossplane-contrib-provider-kubernetes</code> if the provider was installed as part of the dependencies in the configuration package.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The name of the <code>ProviderConfig</code> needs to be <code>storage-kubernetes</code>! The composition will not work with any other name and will not be able to observe resources!</p>
</div>
<pre><code class="language-yaml">
---
apiVersion: pkg.crossplane.io/v1
kind: Provider
metadata:
  name: &lt;name&gt;
spec:
  package: xpkg.crossplane.io/crossplane-contrib/provider-kubernetes:&lt;version&gt;
  runtimeConfigRef:
    apiVersion: pkg.crossplane.io/v1beta1
    kind: DeploymentRuntimeConfig
    name: &lt;deploymenRuntimeConfigName&gt;
---
apiVersion: pkg.crossplane.io/v1beta1
kind: DeploymentRuntimeConfig
metadata:
  name: &lt;name&gt;
spec:
  serviceAccountTemplate:
    metadata:
      name: &lt;serviceAccountName&gt;
---
apiVersion: kubernetes.crossplane.io/v1alpha1
kind: ProviderConfig
metadata:
  name: storage-kubernetes
spec:
  credentials:
    source: InjectedIdentity
</code></pre>
<p>This is everything that is needed for the <code>storage-minio</code> configuration package to function properly.</p>
<h3 id="how-to-create-buckets-with-storage-minio">How to create <code>Buckets</code> with <code>storage-minio</code></h3>
<p>In order to create buckets you need to specify the <code>owner</code> and the <code>bucketName</code>. Additionally, you can set the flag <code>discoverable</code> to true which adds an annotation <code>xstorages.pkg.internal/discoverable</code> to the bucket resource.</p>
<pre><code class="language-yaml">apiVersion: pkg.internal/v1beta1
kind: Storage
metadata:
  name: &lt;name&gt;
  namespace: &lt;namespace&gt;
spec:
  owner: &lt;owner&gt;
  buckets:
    - bucketName: &lt;bucketName&gt;
    - bucketName: &lt;bucketName&gt;
      discoverable: true
</code></pre>
<h3 id="how-to-request-access-to-buckets-from-other-owners">How to request access to <code>Buckets</code> from other <code>owners</code></h3>
<p>If an <code>owner</code> wants to request access to a bucket from another <code>owner</code> it can just be added to a claim by specifying the <code>bucketAccessRequests</code>. The permission can either be <code>ReadWrite</code> or <code>ReadOnly</code>.</p>
<pre><code class="language-yaml">apiVersion: pkg.internal/v1beta1
kind: Storage
metadata:
  name: &lt;name&gt;
  namespace: &lt;namespace&gt;
spec:
  ...
  owner: &lt;owner&gt;
  bucketAccessRequests:
    - bucketName: &lt;bucketName&gt;
      permissions: &lt;permission&gt;
  ...
</code></pre>
<p>This creates a Kubernetes object with <code>provider-kubernetes</code> that observes if the <code>&lt;owner&gt;.&lt;permission&gt;.&lt;bucketName&gt;</code> exists. If the other <code>owner</code> has not granted access to the requested bucket yet (this means that the policy does not exist yet), the <code>XStorage</code> object will switch to <code>READY: False</code> and trigger the <code>crossplane</code> reconciliation loop which continuously checks if the policy exists.</p>
<p>If access is granted to the bucket, the policy is created and attached to the <code>User</code> object of the <code>owner</code>. This switches the status of the <code>XStorage</code> object back to <code>READY: True</code>.</p>
<h3 id="how-to-grant-access-to-buckets-to-other-owners">How to grant access to <code>Buckets</code> to other <code>owners</code></h3>
<p>It is possible to grant <code>owners</code> access to a bucket without them first requesting access. However, it is only attached to the user role if the user has requested access to it as well. Similarly to the requests, the claim can include <code>bucketAccessGrants</code> that grant permissions (<code>ReadWrite</code> or <code>ReadOnly</code>) to a bucket to a list of <code>grantees</code>.</p>
<pre><code class="language-yaml">apiVersion: pkg.internal/v1beta1
kind: Storage
metadata:
  name: &lt;name&gt;
  namespace: &lt;namespace&gt;
spec:
  ...
  owner: &lt;owner&gt;
  bucketAccessGrants:
    - bucketName: &lt;bucketName&gt;
      permissions: &lt;permission&gt;
      grantees:
        - &lt;grantee&gt;
  ...
</code></pre>
<p>This creates the <code>&lt;grantee&gt;.&lt;permission&gt;.&lt;bucketName&gt;</code> policy so if the <code>grantee</code> request access to this bucket, they are automatically granted access.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>